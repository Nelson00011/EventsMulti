{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/aylan/OneDrive/Desktop/events/EventsMulti/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/aylan/OneDrive/Desktop/events/EventsMulti/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import{json,redirect}from'react-router-dom';import AuthForm from'../components/AuthForm';import{jsx as _jsx}from\"react/jsx-runtime\";function AuthenticationPage(){return/*#__PURE__*/_jsx(AuthForm,{});}export default AuthenticationPage;export function action(_x){return _action.apply(this,arguments);}function _action(){_action=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(_ref){var request,searchParams,mode,data,authData,response,resData,token,expiration;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:request=_ref.request;searchParams=new URL(request.url).searchParams;mode=searchParams.get('mode')||'login';if(!(mode!=='login'&&mode!=='signup')){_context.next=5;break;}throw json({message:'Unsupported mode.'},{status:422});case 5:_context.next=7;return request.formData();case 7:data=_context.sent;authData={email:data.get('email'),password:data.get('password')};_context.next=11;return fetch('http://localhost:8080/'+mode,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(authData)});case 11:response=_context.sent;if(!(response.status===422||response.status===401)){_context.next=14;break;}return _context.abrupt(\"return\",response);case 14:if(response.ok){_context.next=16;break;}throw json({message:'Could not authenticate user.'},{status:500});case 16:_context.next=18;return response.json();case 18:resData=_context.sent;token=resData.token;//store token to local storage:\nlocalStorage.setItem('token',token);expiration=new Date();expiration.setHours(expiration.getHours()+1);localStorage.setItem('expiration',expiration.toISOString());return _context.abrupt(\"return\",redirect('/'));case 25:case\"end\":return _context.stop();}},_callee);}));return _action.apply(this,arguments);}","map":{"version":3,"names":["json","redirect","AuthForm","jsx","_jsx","AuthenticationPage","action","_x","_action","apply","arguments","_asyncToGenerator","_regeneratorRuntime","mark","_callee","_ref","request","searchParams","mode","data","authData","response","resData","token","expiration","wrap","_callee$","_context","prev","next","URL","url","get","message","status","formData","sent","email","password","fetch","method","headers","body","JSON","stringify","abrupt","ok","localStorage","setItem","Date","setHours","getHours","toISOString","stop"],"sources":["C:/Users/aylan/OneDrive/Desktop/events/EventsMulti/frontend/src/pages/Authentication.js"],"sourcesContent":["import { json, redirect } from 'react-router-dom';\n\nimport AuthForm from '../components/AuthForm';\n\nfunction AuthenticationPage() {\n  return <AuthForm />;\n}\n\nexport default AuthenticationPage;\n\nexport async function action({ request }) {\n  const searchParams = new URL(request.url).searchParams;\n  const mode = searchParams.get('mode') || 'login';\n\n  if (mode !== 'login' && mode !== 'signup') {\n    throw json({ message: 'Unsupported mode.' }, { status: 422 });\n  }\n\n  const data = await request.formData();\n  const authData = {\n    email: data.get('email'),\n    password: data.get('password'),\n  };\n\n  const response = await fetch('http://localhost:8080/' + mode, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n    },\n    body: JSON.stringify(authData),\n  });\n\n  if (response.status === 422 || response.status === 401) {\n    return response;\n  }\n\n  if (!response.ok) {\n    throw json({ message: 'Could not authenticate user.' }, { status: 500 });\n  }\n\n  //TODO\nconst resData = await response.json();\nconst token = resData.token;\n\n//store token to local storage:\nlocalStorage.setItem('token', token)\nconst expiration = new Date();\nexpiration.setHours(expiration.getHours() + 1);\nlocalStorage.setItem('expiration', expiration.toISOString());\n\n  return redirect('/');\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}