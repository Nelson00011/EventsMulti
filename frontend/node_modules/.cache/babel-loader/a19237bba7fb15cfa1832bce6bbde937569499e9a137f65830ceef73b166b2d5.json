{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/aylan/OneDrive/Desktop/events/EventsMulti/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/aylan/OneDrive/Desktop/events/EventsMulti/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import{Suspense}from'react';import{useRouteLoaderData,json,redirect,defer,Await}from'react-router-dom';import EventItem from'../components/EventItem';import EventsList from'../components/EventsList';import{getAuthToken}from'../uti/auth';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function EventDetailPage(){var _useRouteLoaderData=useRouteLoaderData('event-detail'),event=_useRouteLoaderData.event,events=_useRouteLoaderData.events;return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Suspense,{fallback:/*#__PURE__*/_jsx(\"p\",{style:{textAlign:'center'},children:\"Loading...\"}),children:/*#__PURE__*/_jsx(Await,{resolve:event,children:function children(loadedEvent){return/*#__PURE__*/_jsx(EventItem,{event:loadedEvent});}})}),/*#__PURE__*/_jsx(Suspense,{fallback:/*#__PURE__*/_jsx(\"p\",{style:{textAlign:'center'},children:\"Loading...\"}),children:/*#__PURE__*/_jsx(Await,{resolve:events,children:function children(loadedEvents){return/*#__PURE__*/_jsx(EventsList,{events:loadedEvents});}})})]});}export default EventDetailPage;function loadEvent(_x){return _loadEvent.apply(this,arguments);}function _loadEvent(){_loadEvent=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(id){var response,resData;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.next=2;return fetch('http://localhost:8080/events/'+id);case 2:response=_context.sent;if(response.ok){_context.next=7;break;}throw json({message:'Could not fetch details for selected event.'},{status:500});case 7:_context.next=9;return response.json();case 9:resData=_context.sent;return _context.abrupt(\"return\",resData.event);case 11:case\"end\":return _context.stop();}},_callee);}));return _loadEvent.apply(this,arguments);}function loadEvents(){return _loadEvents.apply(this,arguments);}function _loadEvents(){_loadEvents=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var response,resData;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_context2.next=2;return fetch('http://localhost:8080/events');case 2:response=_context2.sent;if(response.ok){_context2.next=7;break;}throw json({message:'Could not fetch events.'},{status:500});case 7:_context2.next=9;return response.json();case 9:resData=_context2.sent;return _context2.abrupt(\"return\",resData.events);case 11:case\"end\":return _context2.stop();}},_callee2);}));return _loadEvents.apply(this,arguments);}export function loader(_x2){return _loader.apply(this,arguments);}//delete an Event action with auth\nfunction _loader(){_loader=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(_ref){var request,params,id;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1)switch(_context3.prev=_context3.next){case 0:request=_ref.request,params=_ref.params;id=params.eventId;_context3.t0=defer;_context3.next=5;return loadEvent(id);case 5:_context3.t1=_context3.sent;_context3.t2=loadEvents();_context3.t3={event:_context3.t1,events:_context3.t2};return _context3.abrupt(\"return\",(0,_context3.t0)(_context3.t3));case 9:case\"end\":return _context3.stop();}},_callee3);}));return _loader.apply(this,arguments);}export function action(_x3){return _action.apply(this,arguments);}function _action(){_action=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4(_ref2){var params,request,eventId,token,response;return _regeneratorRuntime().wrap(function _callee4$(_context4){while(1)switch(_context4.prev=_context4.next){case 0:params=_ref2.params,request=_ref2.request;eventId=params.eventId;token=getAuthToken();_context4.next=5;return fetch(\"http://localhost:8080/events/\".concat(eventId),{method:request.method,headers:{'Authorization':\"Bearer \"+token}});case 5:response=_context4.sent;if(response.ok){_context4.next=8;break;}throw json({message:'Could not delete event.'},{status:500});case 8:return _context4.abrupt(\"return\",redirect('/events'));case 9:case\"end\":return _context4.stop();}},_callee4);}));return _action.apply(this,arguments);}","map":{"version":3,"names":["Suspense","useRouteLoaderData","json","redirect","defer","Await","EventItem","EventsList","getAuthToken","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","EventDetailPage","_useRouteLoaderData","event","events","children","fallback","style","textAlign","resolve","loadedEvent","loadedEvents","loadEvent","_x","_loadEvent","apply","arguments","_asyncToGenerator","_regeneratorRuntime","mark","_callee","id","response","resData","wrap","_callee$","_context","prev","next","fetch","sent","ok","message","status","abrupt","stop","loadEvents","_loadEvents","_callee2","_callee2$","_context2","loader","_x2","_loader","_callee3","_ref","request","params","_callee3$","_context3","eventId","t0","t1","t2","t3","action","_x3","_action","_callee4","_ref2","token","_callee4$","_context4","concat","method","headers"],"sources":["C:/Users/aylan/OneDrive/Desktop/events/EventsMulti/frontend/src/pages/EventDetail.js"],"sourcesContent":["import { Suspense } from 'react';\r\nimport {\r\n  useRouteLoaderData,\r\n  json,\r\n  redirect,\r\n  defer,\r\n  Await,\r\n} from 'react-router-dom';\r\n\r\nimport EventItem from '../components/EventItem';\r\nimport EventsList from '../components/EventsList';\r\nimport { getAuthToken } from '../uti/auth';\r\n\r\n\r\nfunction EventDetailPage() {\r\n  const { event, events } = useRouteLoaderData('event-detail');\r\n\r\n  return (\r\n    <>\r\n      <Suspense fallback={<p style={{ textAlign: 'center' }}>Loading...</p>}>\r\n        <Await resolve={event}>\r\n          {(loadedEvent) => <EventItem event={loadedEvent} />}\r\n        </Await>\r\n      </Suspense>\r\n      <Suspense fallback={<p style={{ textAlign: 'center' }}>Loading...</p>}>\r\n        <Await resolve={events}>\r\n          {(loadedEvents) => <EventsList events={loadedEvents} />}\r\n        </Await>\r\n      </Suspense>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default EventDetailPage;\r\n\r\n\r\nasync function loadEvent(id) {\r\n  const response = await fetch('http://localhost:8080/events/' + id);\r\n\r\n  if (!response.ok) {\r\n    throw json(\r\n      { message: 'Could not fetch details for selected event.' },\r\n      {\r\n        status: 500,\r\n      }\r\n    );\r\n  } else {\r\n    const resData = await response.json();\r\n    return resData.event;\r\n  }\r\n}\r\n\r\nasync function loadEvents() {\r\n  const response = await fetch('http://localhost:8080/events');\r\n\r\n  if (!response.ok) {\r\n    // return { isError: true, message: 'Could not fetch events.' };\r\n    // throw new Response(JSON.stringify({ message: 'Could not fetch events.' }), {\r\n    //   status: 500,\r\n    // });\r\n    throw json(\r\n      { message: 'Could not fetch events.' },\r\n      {\r\n        status: 500,\r\n      }\r\n    );\r\n  } else {\r\n    const resData = await response.json();\r\n    return resData.events;\r\n  }\r\n}\r\n\r\nexport async function loader({ request, params }) {\r\n  const id = params.eventId;\r\n  \r\n\r\n  return defer({\r\n    event: await loadEvent(id),\r\n    events: loadEvents(),\r\n  });\r\n}\r\n\r\n//delete an Event action with auth\r\nexport async function action({ params, request }) {\r\n  const eventId = params.eventId;\r\n\r\n  const token = getAuthToken();\r\n  const response = await fetch(`http://localhost:8080/events/${eventId}`, {\r\n    method: request.method,\r\n    headers: {\r\n      'Authorization': \"Bearer \" + token,\r\n    }\r\n  });\r\n\r\n  if (!response.ok) {\r\n    throw json(\r\n      { message: 'Could not delete event.' },\r\n      { status: 500 }\r\n    );\r\n  }\r\n  return redirect('/events');\r\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}