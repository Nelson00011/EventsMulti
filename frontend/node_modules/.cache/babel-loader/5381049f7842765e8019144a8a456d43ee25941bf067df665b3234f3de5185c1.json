{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/aylan/OneDrive/Desktop/events/EventsMulti/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/aylan/OneDrive/Desktop/events/EventsMulti/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import{Form,useNavigate,useNavigation,useActionData,json,redirect}from'react-router-dom';import classes from'./EventForm.module.css';import{getAuthToken}from'../uti/auth';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function EventForm(_ref){var method=_ref.method,event=_ref.event;var data=useActionData();var navigate=useNavigate();var navigation=useNavigation();var isSubmitting=navigation.state==='submitting';function cancelHandler(){navigate('..');}return/*#__PURE__*/_jsxs(Form,{method:method,className:classes.form,children:[data&&data.errors&&/*#__PURE__*/_jsx(\"ul\",{children:Object.values(data.errors).map(function(err){return/*#__PURE__*/_jsx(\"li\",{children:err},err);})}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"title\",children:\"Title\"}),/*#__PURE__*/_jsx(\"input\",{id:\"title\",type:\"text\",name:\"title\",required:true,defaultValue:event?event.title:\"\"})]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"image\",children:\"Image\"}),/*#__PURE__*/_jsx(\"input\",{id:\"image\",type:\"url\",name:\"image\",required:true,defaultValue:event?event.image:\"\"})]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"date\",children:\"Date\"}),/*#__PURE__*/_jsx(\"input\",{id:\"date\",type:\"date\",name:\"date\",required:true,defaultValue:event?event.date:\"\"})]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"description\",children:\"Description\"}),/*#__PURE__*/_jsx(\"textarea\",{id:\"description\",name:\"description\",rows:\"5\",required:true,defaultValue:event?event.description:\"\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:classes.actions,children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:cancelHandler,disabled:isSubmitting,children:\"Cancel\"}),/*#__PURE__*/_jsx(\"button\",{disabled:isSubmitting,children:isSubmitting?\"Submitting...\":\"Save\"})]})]});}export default EventForm;export function action(_x){return _action.apply(this,arguments);}function _action(){_action=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(_ref2){var request,params,method,data,eventData,url,eventId,token,response;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:request=_ref2.request,params=_ref2.params;method=request.method;_context.next=4;return request.formData();case 4:data=_context.sent;eventData={title:data.get('title'),image:data.get('image'),date:data.get('date'),description:data.get('description')};url='http://localhost:8080/events';if(method==='PATCH'){eventId=params.eventId;url='http://localhost:8080/events/'+eventId;}token=getAuthToken();_context.next=11;return fetch(url,{method:method,headers:{'Content-Type':'application/json','Authorization':'Bearer '+token},body:JSON.stringify(eventData)});case 11:response=_context.sent;if(!(response.status===422)){_context.next=14;break;}return _context.abrupt(\"return\",response);case 14:if(response.ok){_context.next=16;break;}throw json({message:'Could not save event.'},{status:500});case 16:return _context.abrupt(\"return\",redirect('/events'));case 17:case\"end\":return _context.stop();}},_callee);}));return _action.apply(this,arguments);}","map":{"version":3,"names":["Form","useNavigate","useNavigation","useActionData","json","redirect","classes","getAuthToken","jsx","_jsx","jsxs","_jsxs","EventForm","_ref","method","event","data","navigate","navigation","isSubmitting","state","cancelHandler","className","form","children","errors","Object","values","map","err","htmlFor","id","type","name","required","defaultValue","title","image","date","rows","description","actions","onClick","disabled","action","_x","_action","apply","arguments","_asyncToGenerator","_regeneratorRuntime","mark","_callee","_ref2","request","params","eventData","url","eventId","token","response","wrap","_callee$","_context","prev","next","formData","sent","get","fetch","headers","body","JSON","stringify","status","abrupt","ok","message","stop"],"sources":["C:/Users/aylan/OneDrive/Desktop/events/EventsMulti/frontend/src/components/EventForm.js"],"sourcesContent":["import { Form, useNavigate, useNavigation, useActionData, json, redirect } from 'react-router-dom';\n\nimport classes from './EventForm.module.css';\nimport { getAuthToken } from '../uti/auth';\n\nfunction EventForm({ method, event }) {\n  const data = useActionData();\n  const navigate = useNavigate();\n  const navigation = useNavigation();\n\n  const isSubmitting = navigation.state === 'submitting';\n\n\n  function cancelHandler() {\n    navigate('..');\n  }\n\n  return (\n    <Form method={method} className={classes.form}>\n        {data && data.errors && (\n        <ul>\n          {Object.values(data.errors).map((err) => (\n            <li key={err}>{err}</li>\n          ))}\n        </ul>\n      )}\n      <p>\n        <label htmlFor=\"title\">Title</label>\n        <input id=\"title\" type=\"text\" name=\"title\" required defaultValue={event ? event.title : \"\"}/>\n      </p>\n      <p>\n        <label htmlFor=\"image\">Image</label>\n        <input id=\"image\" type=\"url\" name=\"image\" required defaultValue={event ? event.image : \"\"}/>\n      </p>\n      <p>\n        <label htmlFor=\"date\">Date</label>\n        <input id=\"date\" type=\"date\" name=\"date\" required defaultValue={event ? event.date : \"\"}/>\n      </p>\n      <p>\n        <label htmlFor=\"description\">Description</label>\n        <textarea id=\"description\" name=\"description\" rows=\"5\" required defaultValue={event ? event.description : \"\"}/>\n      </p>\n      <div className={classes.actions}>\n        <button type=\"button\" onClick={cancelHandler} disabled={isSubmitting}>\n          Cancel\n        </button>\n        <button disabled={isSubmitting}>{isSubmitting ? \"Submitting...\" : \"Save\"}</button>\n      </div>\n    </Form>\n  );\n}\n\nexport default EventForm;\n\n\nexport async function action ({ request, params }){\n  const method = request.method;\n  const data = await request.formData();\n\n  const eventData = {\n    title: data.get('title'),\n    image: data.get('image'),\n    date: data.get('date'),\n    description: data.get('description'),\n  };\n\n  let url = 'http://localhost:8080/events';\n\n  if (method === 'PATCH') {\n    const eventId = params.eventId;\n    url = 'http://localhost:8080/events/' + eventId;\n  }\n\n  const token = getAuthToken();\n  const response = await fetch(url, {\n    method: method,\n    headers: {\n      'Content-Type': 'application/json',\n      'Authorization': 'Bearer ' + token\n    },\n    body: JSON.stringify(eventData),\n  });\n\n  if (response.status === 422) {\n    return response;\n  }\n\n  if (!response.ok) {\n    throw json({ message: 'Could not save event.' }, { status: 500 });\n  }\n\n  return redirect('/events');\n  //Final Bracket\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}